function $(r){return document.getElementById(r)}function showerr(r){setTimeout("$('msg').innerHTML='"+$("msg").innerHTML+"';",3e3),$("msg").innerHTML=""+r}var i,j,bx=new Array(10),by=new Array(10),bxy=new Array(4),sd=new Array(10);for(i=0;i<4;i++)for(bxy[i]=new Array(4),j=0;j<4;j++)bxy[i][j]=new Array(10);for(j=0;j<10;j++)bx[j]=new Array(10),by[j]=new Array(10),sd[j]=new Array(10);function slove(r,e){var n,i,o,s,f;if(0==sd[r][e]){for(n=1;n<=9;n++)if(s=parseInt((r+2)/3),f=parseInt((e+2)/3),bx[r][n]&&by[e][n]&&bxy[s][f][n]){if(bx[r][n]=!1,by[e][n]=!1,bxy[s][f][n]=!1,sd[r][e]=n,9==r){if(9==e)return!0;i=1,o=e+1}else i=r+1,o=e;if(slove(i,o))return!0;sd[r][e]=0,bx[r][n]=!0,by[e][n]=!0,bxy[s][f][n]=!0}}else{if(9==r){if(9==e)return!0;i=1,o=e+1}else i=r+1,o=e;if(slove(i,o))return!0}return!1}$("slove").onclick=function(){var r,e,n,i,o,s;for(r=0;r<4;r++)for(e=0;e<4;e++)for(n=0;n<10;n++)bxy[r][e][n]=!0;for(r=0;r<10;r++)for(e=0;e<10;e++)by[r][e]=!0,bx[r][e]=!0,sd[r][e]=0;for(r=1;r<=9;r++)for(e=1;e<=9;e++)if($("cell"+r+e).innerHTML=$("cell"+r+e).innerHTML.replace(/<.+?>|[^0-9]+/,""),""!=(i=$("cell"+r+e).innerHTML)&&"0"!=i){if(i=parseInt(i),isNaN(i))return showerr("第"+e+"行，第"+r+"列 非法字符！"),void $("cell"+r+e).focus();if(i<=9&&i>0){if(o=parseInt((r+2)/3),s=parseInt((e+2)/3),!(bx[r][i]&&by[e][i]&&bxy[o][s][i]))return showerr("第"+e+"行，第"+r+"列 值有问题，不合法的输入，重复了！"),void $("cell"+r+e).focus();bx[r][i]=!1,by[e][i]=!1,bxy[o][s][i]=!1,sd[r][e]=i}else if(0!=i)return showerr("第"+e+"行，第"+r+"列 非法数字！"),void $("cell"+r+e).focus()}if(slove(1,1))for(r=1;r<=9;r++)for(e=1;e<=9;e++)$("cell"+r+e).innerHTML=sd[r][e];else showerr("真遗憾，这个数独没有解～")},$("reset").onclick=function(){for(i=1;i<=9;i++)for(j=1;j<=9;j++)$("cell"+i+j).innerHTML=""},$("sudoku").onkeypress=function(r){var e,n;return null==r?(n=event.shiftKey,e=event.keyCode):(e=r.which,n=r.shiftKey),!n&&e>47&&e<58};