const canvas=document.getElementById("source"),ctx=canvas.getContext("2d"),image=new Image;image.onload=function(){console.log(image.width,image.height),console.log(canvas.width,canvas.height),ctx.drawImage(image,0,0,image.width,image.height,(canvas.width-image.width)/2,(canvas.height-image.height)/2,image.width,image.height);const e=ctx.getImageData(0,0,canvas.width,canvas.height),t=e.data;console.log(e);const o=canvas.width,a=canvas.height;for(let e=0;e<o;e++)for(let i=0;i<a;i++){const r=4*(i*o+e),n={r:t[r],g:t[r+1],b:t[r+2],a:t[r+3]},s=0!==n.a;let g=o,h=a,l=0,m=0;s&&(g=Math.min(e,g),l=Math.max(e,g),h=Math.min(i,h),m=Math.max(i,m)),l+=1,m+=1,g-=10,h-=10,l+=10,m+=10,console.log(`col ${e}, row ${i}, ${n.a}`)}const i=[(()=>{for(let e=0;e<o;e++)for(let i=0;i<a;i++)if(t[4*(i*o+e)+3]>0)return Promise.resolve(e);return Promise.resolve(0)})(),(()=>{for(let e=0;e<a;e++)for(let a=0;a<o;a++)if(t[4*(e*o+a)+3]>0)return Promise.resolve(e);return Promise.resolve(0)})(),(()=>{for(let e=o-1;e>=0;e--)for(let i=0;i<a;i++)if(t[4*(i*o+e)+3]>0)return Promise.resolve(e);return Promise.resolve(0)})(),(()=>{for(let e=a-1;e>=0;e--)for(let a=0;a<o;a++)if(t[4*(e*o+a)+3]>0)return Promise.resolve(e);return Promise.resolve(0)})()];Promise.all(i).then((e=>{let[t,o,a,i]=e;console.log(t,o,a,i);const r=document.getElementById("preview"),n=r.getContext("2d");r.width=a-t,r.height=i-o,n.drawImage(image,t,o,r.width,r.height,0,0,r.width,r.height),r.toDataURL()}))},image.src="./apple logo.bmp",image.crossOrigin="Anonymous";